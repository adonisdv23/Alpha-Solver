# CODE SPEC — NEW-021 · CI/CD Pipeline for MVP Gates (RES_07)

## Goal
Implement CI/CD Pipeline for MVP Gates in track RES_07 with enforceable tests.

## Acceptance Criteria (must all pass)
- Pipeline triggers on PR and main; completes in ≤ 10 min p95.
- Determinism: 10/10 stable replays (no flaps).
- Policy/PII: 0 PII in logs; ≥99% detection emails/phones on labeled sample.
- Budget guard: blocks when thresholds exceeded; `budget_verdict` surfaced.
- Metrics: /metrics includes required series; test uses ASGI TestClient (no sockets).
- Coverage ≥ 95% lines.

## Code Targets
- .github/workflows/ci.yml
- tests/test_policy_pii_gateway.py
- tests/test_budget_guard.py
- tests/test_determinism_harness.py
- tests/test_metrics_dashboards.py

## Design Notes
- Python 3.12; pip cache
- Run fast unit tests first; then gates in parallel
- No fixed ports; use TestClient
- Redact secrets in logs

## Evidence
- CI run URL, coverage report, and artifacts linked in the PR
